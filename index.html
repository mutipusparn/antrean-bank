<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Antrean Bank Jateng</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 20px; }
        h2 { color: #333; }
        table { width: 80%; margin: auto; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        th { background-color: #f4b400; color: white; }
    </style>
</head>
<body>

    <h2>Antrean Bank Jateng KCP Sumpiuh</h2>
    <table id="queueTable">
        <thead>
            <tr>
                <th>No. Antrian</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody id="queueBody">
            <tr><td colspan="3">Memuat data...</td></tr>
        </tbody>
    </table>

    <script>
        // Link Google Sheets dalam format CSV
        const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSTK_po6MZckPDbbatGaoOOKRKWFM_kAgwcd-RxhTHAXX5N1CHscDVRz4BgpZX0Tg3PJyiFXpWEmxKH/pub?gid=0&single=true&output=csv";

        async function fetchQueueData() {
            const response = await fetch(sheetUrl);
            const data = await response.text();
            const rows = data.split("\n").map(row => row.split(","));
            
            let tableHTML = "";
            for (let i = 1; i < rows.length; i++) {  // Mulai dari indeks 1 karena indeks 0 adalah header
                const [noAntrian, status] = rows[i];
                tableHTML += `<tr>
                    <td>${noAntrian}</td>
                    <td>${status}</td>
                </tr>`;
            }
            document.getElementById("queueBody").innerHTML = tableHTML;
        }

        fetchQueueData(); // Jalankan pertama kali
        setInterval(fetchQueueData, 10000); // Perbarui setiap 10 detik
    </script>

</body>
</html>
